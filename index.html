<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bayside — Dashboard</title>
  <!-- Hide content until auth status is known -->
  <style>
    html{visibility:hidden}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#f6f7fb;color:#0f172a}
    .topbar{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;background:#fff;border-bottom:1px solid #e5e7eb}
    .btn{background:#0f172a;color:#fff;border:0;border-radius:10px;padding:10px 14px;font-weight:600;cursor:pointer}
    .wrap{max-width:1000px;margin:24px auto;padding:0 16px}
    .card{background:#fff;border-radius:14px;box-shadow:0 6px 22px rgba(16,24,40,.08);padding:20px}
    h1{margin:0;font-size:22px}
  </style>

  <!-- Firebase SDK + your config -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
  <script src="firebase-init.js"></script>

  <script>
    // Gate: only show if signed-in; else go to login
    (function(){
      firebase.auth().onAuthStateChanged(function(user){
        if (user) {
          // Show page
          document.documentElement.style.visibility = 'visible';
          // Optionally display the user's email/name
          const el = document.getElementById('whoami');
          if (el) el.textContent = user.email || 'Signed in';
        } else {
          // Not signed in → login with safe next back to index
          const next = encodeURIComponent(location.pathname + location.search + location.hash);
          location.replace('login.html?next=' + next);
        }
      });
    })();
  </script>
</head>
<body>
  <div class="topbar">
    <h1>Bayside Dashboard</h1>
    <div>
      <span id="whoami" style="margin-right:12px;color:#334155;"></span>
      <button class="btn" id="logoutBtn">Sign out</button>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <p>Welcome to the dashboard. Replace this content with your actual app UI.</p>
      <ul>
        <li>If you need to load Firestore here, we can add it next (step by step).</li>
        <li>If App Check is enforced, we’ll wire that in carefully after this works.</li>
      </ul>
    </div>
  </div>

  <script>
    // Sign out button
    document.getElementById('logoutBtn').addEventListener('click', async () => {
      try { await firebase.auth().signOut(); } finally { location.href = 'login.html'; }
    });
  </script>
</body>
</html>
